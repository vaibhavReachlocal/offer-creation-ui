app.controller('offerCreationController', function ($scope,$rootScope,offerService) {
   // $scope.showValue = true;
   // $scope.offerDetails = {"offer":{"id":2008,"idWebPublisher":65,"idWebPublisherProvisioningFulfillment":0,"idWebPublisherReportingFulfillment":0,"idOfferMediaType":3,"idOfferPricingModelVendor":3,"idOfferPricingModelExchange":3,"idOfferStatus":2,"idOfferType":1,"idDivision":1,"idCampaignType":1,"idCampaignSubType":28,"idAutoEndType":1,"idAllocationType":2,"idBiddingPricingModel":3,"idAdvertisingCategory":5,"idOfferPricingTypeVendor":2,"idOfferPricingTypeExchange":2,"idOfferMaster":2008,"idOfferParent":0,"idWebLocation":0,"idWebPublisherRelationshipLevel":1,"idWebPublisherExternalAccount":0,"idOfferMediaMarkupType":2,"idTaxGroup":1,"idGeoType":0,"offerName":"YouTube Advertising","offerDescription":"YouTube Advertising Offer","vendorMinCost":0.10,"vendorMaxCost":50.00,"vendorRecommendedCost":1.00,"vendorPrice":0.00,"vendorRecommendedPrice":0.00,"xchangeMinCost":0.10,"xchangeMaxCost":50.00,"xchangeRecommendedCost":1.00,"xchangePrice":0.00,"xchangeRecommendedPrice":0.00,"xchangeListingPrice":null,"xchangeMinBudget":500.00,"xchangeMaxBudget":99999.00,"xchangeListingBudget":null,"vendorMinBudget":500.00,"vendorMaxBudget":99999.00,"displayStartDate":1504636200000,"displayEndDate":4102338600000,"runStartDate":1504636200000,"runEndDate":4102338600000,"leadTime":3,"campaignDuration":30,"cycleDuration":30,"adGuidelines":"","maxKeywords":0,"maxAds":12,"maxCategories":0,"maxRenewalCycles":99,"allowsFrequencyCapping":false,"allowsRenewal":true,"allowsPausing":true,"allowsEnding":true,"allowsBidUpdate":true,"allowsBudgetUpdate":true,"allowsGeoUpdate":true,"allowsAdUpdate":true,"allowsCategoryUpdate":false,"allowsKeywordUpdate":false,"allowsAdGroups":false,"allowsSiteLinks":0,"allowsBudgetTool":false,"allowsTrackingEmail":true,"allowsTrackingPhone":true,"allowsCampaignBuy":true,"useKeywords":false,"useArbitragePricing":false,"hasKeywordreporting":false,"hasImpressions":true,"hasRemarketing":true,"useEntryVisits":false,"useRawCost":true,"useRlClicks":false,"isLumpSum":false,"isFeatured":false,"canModifyOffer":false,"showPrice":true,"showBudget":true,"isBudgetLocked":false,"automation":false,"currency":"AUD","proposalTemplateId":0,"idBusinessUserCreatedBy":1,"idBusinessUserLastModifiedBy":1,"offerCreated":1504690078000,"offerModified":1505747709000,"offerStartDate":1504690078000,"offerPauseDate":null,"offerEndDate":null,"segmentCookieDuration":2592000,"adTags":"allowed","campaignCreationType":"dynamic","requiresPayment":true,"supportsProxyPageRedirection":false,"maxCampaignBudget":100000.00,"allowsMediaPlan":null},"hasCampaignTypes":[{"idAdvertiser":0,"idCampaignType":1,"idCampaignSubType":28,"businessName":"test_reachlocal_agency","cobrandName":null,"productName":"Youtube Video Advertising","businessId":2,"cobrandId":0,"offerId":2008}],"offerMetadatas":[],"offerOptions":[{"id":118378,"idOffer":2008,"ooTableName":"BusinessCategory","ooTableValue":"0"},{"id":118379,"idOffer":2008,"ooTableName":"CountryCode","ooTableValue":"USA"},{"id":118380,"idOffer":2008,"ooTableName":"StateAbbreviations","ooTableValue":"0"},{"id":118381,"idOffer":2008,"ooTableName":"TargetType","ooTableValue":"1"},{"id":118382,"idOffer":2008,"ooTableName":"TargetType","ooTableValue":"3"},{"id":118383,"idOffer":2008,"ooTableName":"TargetType","ooTableValue":"4"},{"id":118384,"idOffer":2008,"ooTableName":"TargetType","ooTableValue":"6"}],"offerBundle":[],"productFamilyOffer":[{"offerId":2008,"isAddon":false,"productAbbreviation":null,"productFamilyName":"Display","displayOrder":0,"productFamilyId":2}],"hasMarginPercents":[],"hasDefaultOffers":[],"offerProductURI":[],"offerHasCreativeTypes":[{"id":51121,"idOffer":2008,"idCreativeType":3,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51122,"idOffer":2008,"idCreativeType":3,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51123,"idOffer":2008,"idCreativeType":4,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51124,"idOffer":2008,"idCreativeType":4,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51125,"idOffer":2008,"idCreativeType":5,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51126,"idOffer":2008,"idCreativeType":5,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51127,"idOffer":2008,"idCreativeType":9,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51128,"idOffer":2008,"idCreativeType":9,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51129,"idOffer":2008,"idCreativeType":10,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51130,"idOffer":2008,"idCreativeType":10,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51131,"idOffer":2008,"idCreativeType":11,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51132,"idOffer":2008,"idCreativeType":11,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51133,"idOffer":2008,"idCreativeType":12,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51134,"idOffer":2008,"idCreativeType":12,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51135,"idOffer":2008,"idCreativeType":13,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51136,"idOffer":2008,"idCreativeType":13,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51137,"idOffer":2008,"idCreativeType":23,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51138,"idOffer":2008,"idCreativeType":23,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51139,"idOffer":2008,"idCreativeType":32,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51140,"idOffer":2008,"idCreativeType":32,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51141,"idOffer":2008,"idCreativeType":41,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51142,"idOffer":2008,"idCreativeType":41,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51143,"idOffer":2008,"idCreativeType":42,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51144,"idOffer":2008,"idCreativeType":42,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51145,"idOffer":2008,"idCreativeType":47,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51146,"idOffer":2008,"idCreativeType":47,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51147,"idOffer":2008,"idCreativeType":49,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51148,"idOffer":2008,"idCreativeType":49,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51149,"idOffer":2008,"idCreativeType":52,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51150,"idOffer":2008,"idCreativeType":52,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12"},{"id":51151,"idOffer":2008,"idCreativeType":54,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"1|2|3|4|12|14"},{"id":51152,"idOffer":2008,"idCreativeType":54,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"200"},{"id":51153,"idOffer":2008,"idCreativeType":123,"idCreativeFields":10,"idMediaAttributes":6,"required":true,"mediaAttributeValue":"7200"},{"id":51154,"idOffer":2008,"idCreativeType":123,"idCreativeFields":10,"idMediaAttributes":1,"required":true,"mediaAttributeValue":"1048576"},{"id":51155,"idOffer":2008,"idCreativeType":123,"idCreativeFields":10,"idMediaAttributes":5,"required":true,"mediaAttributeValue":"32|34"}],"offerHasEnhancedCreativeGroups":[],"campaignFormTemplates":[],"campaignValidationRules":[],"platformOfferProducts":[]};
    $scope.jira = {"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog,versionedRepresentations","id":"999196","self":"https://tickets.reachlocal.com/rest/api/2/issue/999196","key":"BUSSRV-9700","fields":{"resolution":null,"customfield_310952":null,"customfield_310951":null,"lastViewed":null,"aggregatetimeoriginalestimate":null,"issuelinks":[{"id":"737650","self":"https://tickets.reachlocal.com/rest/api/2/issueLink/737650","type":{"id":"310001","name":"Cloners","inward":"is cloned by","outward":"clones","self":"https://tickets.reachlocal.com/rest/api/2/issueLinkType/310001"},"inwardIssue":{"id":"1004833","key":"BUSSRV-9834","self":"https://tickets.reachlocal.com/rest/api/2/issue/1004833","fields":{"summary":"Replicate CAN Offer 1441 and set price to '$299', offer_name to 'ReachSite Monthly'","status":{"self":"https://tickets.reachlocal.com/rest/api/2/status/11084","description":"","iconUrl":"https://tickets.reachlocal.com/images/icons/status_generic.gif","name":"Under Review","id":"11084","statusCategory":{"self":"https://tickets.reachlocal.com/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"priority":{"self":"https://tickets.reachlocal.com/rest/api/2/priority/4","iconUrl":"https://tickets.reachlocal.com/images/icons/priorities/minor.svg","name":"Medium","id":"4"},"issuetype":{"self":"https://tickets.reachlocal.com/rest/api/2/issuetype/10501","id":"10501","description":"New Issue type in BUSSRV project","iconUrl":"https://tickets.reachlocal.com/secure/viewavatar?size=xsmall&avatarId=12690&avatarType=issuetype","name":"Offer Creation","subtask":false,"avatarId":12690}}}}],"assignee":{"self":"https://tickets.reachlocal.com/rest/api/2/user?username=sharris","name":"sharris","key":"sharris","emailAddress":"sharris@reachlocal.com","avatarUrls":{"48x48":"https://tickets.reachlocal.com/secure/useravatar?avatarId=13518","24x24":"https://tickets.reachlocal.com/secure/useravatar?size=small&avatarId=13518","16x16":"https://tickets.reachlocal.com/secure/useravatar?size=xsmall&avatarId=13518","32x32":"https://tickets.reachlocal.com/secure/useravatar?size=medium&avatarId=13518"},"displayName":"Sam Harris","active":true,"timeZone":"US/Pacific"},"customfield_310850":null,"customfield_311950":{"errorMessage":"The Service Desk you are trying to view does not exist.","i18nErrorMessage":{"i18nKey":"sd.agent.servicedesk.error.servicedesk.missing","parameters":[]}},"subtasks":[],"customfield_311958":null,"customfield_311957":null,"customfield_311956":null,"customfield_311955":null,"customfield_311954":null,"customfield_311953":null,"customfield_310500":null,"customfield_311952":null,"customfield_311951":[],"votes":{"self":"https://tickets.reachlocal.com/rest/api/2/issue/BUSSRV-9700/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"issuetype":{"self":"https://tickets.reachlocal.com/rest/api/2/issuetype/10501","id":"10501","description":"New Issue type in BUSSRV project","iconUrl":"https://tickets.reachlocal.com/secure/viewavatar?size=xsmall&avatarId=12690&avatarType=issuetype","name":"Offer Creation","subtask":false,"avatarId":12690},"customfield_312097":null,"customfield_312090":null,"customfield_312091":null,"customfield_312093":null,"customfield_312094":null,"customfield_312096":null,"timetracking":{},"duedate":"2017-09-01","customfield_312853":null,"customfield_310552":"BUSSRV-9519","customfield_312854":null,"customfield_310551":null,"customfield_312855":{"self":"https://tickets.reachlocal.com/rest/api/2/customFieldOption/314304","value":"No","id":"314304"},"customfield_310550":"9223372036854775807","customfield_312856":100.0,"customfield_312857":{"self":"https://tickets.reachlocal.com/rest/api/2/customFieldOption/314306","value":"No","id":"314306"},"customfield_312858":null,"customfield_312859":null,"customfield_312970":null,"customfield_10112":null,"customfield_312850":null,"customfield_312851":null,"customfield_312852":null,"customfield_310321":null,"customfield_310320":null,"customfield_311650":null,"customfield_312860":null,"customfield_312861":null,"customfield_312862":null,"timeestimate":null,"status":{"self":"https://tickets.reachlocal.com/rest/api/2/status/11084","description":"","iconUrl":"https://tickets.reachlocal.com/images/icons/status_generic.gif","name":"Under Review","id":"11084","statusCategory":{"self":"https://tickets.reachlocal.com/rest/api/2/statuscategory/4","id":4,"key":"indeterminate","colorName":"yellow","name":"In Progress"}},"customfield_310333":2.0,"customfield_310331":null,"customfield_310330":null,"customfield_312750":[{"self":"https://tickets.reachlocal.com/rest/api/2/customFieldOption/314200","value":"Yes","id":"314200"}],"customfield_312751":null,"customfield_312752":null,"aggregatetimeestimate":null,"customfield_311554":null,"customfield_311553":null,"customfield_311552":null,"creator":{"self":"https://tickets.reachlocal.com/rest/api/2/user?username=stephen.caicedo","name":"stephen.caicedo","key":"stephen.caicedo","emailAddress":"stephen.caicedo@reachlocal.com","avatarUrls":{"48x48":"https://tickets.reachlocal.com/secure/useravatar?avatarId=10312","24x24":"https://tickets.reachlocal.com/secure/useravatar?size=small&avatarId=10312","16x16":"https://tickets.reachlocal.com/secure/useravatar?size=xsmall&avatarId=10312","32x32":"https://tickets.reachlocal.com/secure/useravatar?size=medium&avatarId=10312"},"displayName":"Stephen Caicedo","active":true,"timeZone":"US/Pacific"},"customfield_311551":null,"customfield_310340":null,"customfield_311550":null,"customfield_310108":null,"customfield_311557":null,"customfield_311556":null,"customfield_311555":null,"customfield_311961":null,"customfield_310750":null,"customfield_311960":null,"timespent":null,"customfield_311969":null,"customfield_311968":null,"customfield_311967":null,"customfield_311966":null,"customfield_311965":null,"aggregatetimespent":null,"customfield_311964":null,"customfield_311963":null,"customfield_311962":null,"customfield_311959":null,"workratio":-1,"customfield_311972":null,"customfield_311971":null,"customfield_311970":null,"customfield_311979":null,"customfield_311857":null,"customfield_311978":null,"customfield_311977":null,"customfield_311855":null,"customfield_311976":null,"customfield_311854":null,"customfield_311975":null,"customfield_311974":null,"customfield_310521":null,"customfield_311973":null,"customfield_311983":null,"customfield_312952":null,"customfield_311982":null,"customfield_312953":{"errorMessage":"The Service Desk you are trying to view does not exist.","i18nErrorMessage":{"i18nKey":"sd.agent.servicedesk.error.servicedesk.missing","parameters":[]}},"customfield_311981":null,"customfield_312954":{"errorMessage":"The Service Desk you are trying to view does not exist.","i18nErrorMessage":{"i18nKey":"sd.agent.servicedesk.error.servicedesk.missing","parameters":[]}},"customfield_311980":null,"customfield_312955":{"errorMessage":"The Service Desk you are trying to view does not exist.","i18nErrorMessage":{"i18nKey":"sd.agent.servicedesk.error.servicedesk.missing","parameters":[]}},"customfield_312956":{"errorMessage":"The Service Desk you are trying to view does not exist.","i18nErrorMessage":{"i18nKey":"sd.agent.servicedesk.error.servicedesk.missing","parameters":[]}},"customfield_312957":null,"customfield_312959":null,"customfield_311989":null,"customfield_311988":null,"customfield_311987":null,"customfield_311986":null,"customfield_311985":null,"customfield_312950":null,"customfield_311984":null,"customfield_312951":null,"customfield_311752":null,"customfield_311994":null,"customfield_312963":null,"customfield_311751":null,"customfield_311993":null,"customfield_312964":null,"customfield_311992":null,"customfield_312965":null,"customfield_311991":null,"customfield_312966":null,"customfield_311990":null,"customfield_312967":null,"customfield_312968":null,"customfield_311999":null,"customfield_311998":null,"customfield_311997":null,"customfield_312960":null,"customfield_311996":null,"customfield_312961":null,"customfield_311753":null,"customfield_312962":null,"customfield_312457":null,"customfield_312458":null,"customfield_312579":null,"customfield_312570":null,"customfield_312571":null,"customfield_312572":null,"customfield_312573":null,"customfield_312452":null,"customfield_312574":null,"customfield_312453":null,"customfield_312454":null,"customfield_312575":null,"customfield_312455":null,"customfield_312576":null,"customfield_312577":"Launching new ReachSites product in September","customfield_312456":null,"customfield_312468":null,"customfield_312106":null,"customfield_312469":null,"customfield_312107":null,"customfield_312108":null,"customfield_312109":null,"customfield_311251":null,"customfield_311250":null,"customfield_312581":"Launching new ReachSites product in September","customfield_312460":null,"customfield_312461":null,"customfield_312462":null,"customfield_312463":null,"customfield_312464":null,"customfield_312101":null,"customfield_312465":null,"customfield_312466":null,"customfield_312103":null,"labels":[],"customfield_312467":null,"customfield_312580":{"self":"https://tickets.reachlocal.com/rest/api/2/customFieldOption/313999","value":"High","id":"313999"},"customfield_310281":null,"customfield_312116":null,"customfield_312117":null,"components":[],"customfield_312118":null,"customfield_312119":null,"customfield_312350":null,"customfield_312110":null,"customfield_312113":null,"customfield_312114":null,"customfield_312115":null,"customfield_312470":null,"customfield_310050":null,"customfield_312127":null,"customfield_312006":null,"customfield_312007":null,"customfield_312008":null,"customfield_310187":null,"customfield_312009":null,"customfield_312120":null,"reporter":{"self":"https://tickets.reachlocal.com/rest/api/2/user?username=stephen.caicedo","name":"stephen.caicedo","key":"stephen.caicedo","emailAddress":"stephen.caicedo@reachlocal.com","avatarUrls":{"48x48":"https://tickets.reachlocal.com/secure/useravatar?avatarId=10312","24x24":"https://tickets.reachlocal.com/secure/useravatar?size=small&avatarId=10312","16x16":"https://tickets.reachlocal.com/secure/useravatar?size=xsmall&avatarId=10312","32x32":"https://tickets.reachlocal.com/secure/useravatar?size=medium&avatarId=10312"},"displayName":"Stephen Caicedo","active":true,"timeZone":"US/Pacific"},"customfield_312000":null,"customfield_312121":null,"customfield_312001":null,"customfield_312122":null,"customfield_312123":null,"customfield_312002":null,"customfield_312124":null,"customfield_312003":null,"customfield_312004":null,"customfield_312125":null,"customfield_312005":null,"customfield_312126":null,"customfield_311150":"1|i0bx1e:zzy","progress":{"progress":0,"total":0},"customfield_312655":54.0,"customfield_312656":1.0,"customfield_312657":25.0,"customfield_312658":{"errorMessage":"The Service Desk you are trying to view does not exist.","i18nErrorMessage":{"i18nKey":"sd.agent.servicedesk.error.servicedesk.missing","parameters":[]}},"customfield_312659":{"errorMessage":"The Service Desk you are trying to view does not exist.","i18nErrorMessage":{"i18nKey":"sd.agent.servicedesk.error.servicedesk.missing","parameters":[]}},"project":{"self":"https://tickets.reachlocal.com/rest/api/2/project/310191","id":"310191","key":"BUSSRV","name":"Business Systems","avatarUrls":{"48x48":"https://tickets.reachlocal.com/secure/projectavatar?pid=310191&avatarId=10990","24x24":"https://tickets.reachlocal.com/secure/projectavatar?size=small&pid=310191&avatarId=10990","16x16":"https://tickets.reachlocal.com/secure/projectavatar?size=xsmall&pid=310191&avatarId=10990","32x32":"https://tickets.reachlocal.com/secure/projectavatar?size=medium&pid=310191&avatarId=10990"},"projectCategory":{"self":"https://tickets.reachlocal.com/rest/api/2/projectCategory/310000","id":"310000","description":"Integrated Project Teams","name":"IPT"}},"customfield_312650":null,"customfield_312651":null,"customfield_312652":{"self":"https://tickets.reachlocal.com/rest/api/2/user?username=paras.maniar","name":"paras.maniar","key":"paras.maniar","emailAddress":"paras.maniar@reachlocal.com","avatarUrls":{"48x48":"https://tickets.reachlocal.com/secure/useravatar?avatarId=10312","24x24":"https://tickets.reachlocal.com/secure/useravatar?size=small&avatarId=10312","16x16":"https://tickets.reachlocal.com/secure/useravatar?size=xsmall&avatarId=10312","32x32":"https://tickets.reachlocal.com/secure/useravatar?size=medium&avatarId=10312"},"displayName":"Paras Maniar","active":true,"timeZone":"US/Pacific"},"customfield_312653":{"self":"https://tickets.reachlocal.com/rest/api/2/customFieldOption/314112","value":"Dan Gesshel","id":"314112"},"resolutiondate":null,"watches":{"self":"https://tickets.reachlocal.com/rest/api/2/issue/BUSSRV-9700/watchers","watchCount":5,"isWatching":false},"customfield_312660":{"errorMessage":"The Service Desk you are trying to view does not exist.","i18nErrorMessage":{"i18nKey":"sd.agent.servicedesk.error.servicedesk.missing","parameters":[]}},"updated":"2017-09-24T17:37:18.000-0700","customfield_310375":null,"customfield_312558":{"self":"https://tickets.reachlocal.com/rest/api/2/customFieldOption/313471","value":"Fixed","id":"313471"},"customfield_312559":79.0,"customfield_310373":null,"customfield_310371":null,"timeoriginalestimate":null,"description":"Please replicate CAN Offer 1441 and set price to '$79', offer_name to 'ReachSite Subscription'\r\n\r\n(Note: Number of Cycles should be '99' - not '12' - '99' for evergreen is not an option in the offer creation ticket - please reference offer 1441 for all fields and margins - offer creation ticket does not allow some values)\r\n\r\nMargin % is 46.41","customfield_312550":null,"customfield_312551":null,"customfield_312552":"Dan Gesshel","customfield_312553":1441.0,"customfield_312555":"ReachSite Subscription","summary":"Replicate CAN Offer 1441 and set price to '$79', offer_name to 'ReachSite Subscription'","customfield_312567":"CAD","customfield_312568":"46.41","customfield_312569":{"self":"https://tickets.reachlocal.com/rest/api/2/customFieldOption/313506","value":"Yes","id":"313506"},"customfield_311351":null,"customfield_312560":79.0,"customfield_312561":79.0,"customfield_312562":{"self":"https://tickets.reachlocal.com/rest/api/2/customFieldOption/313474","value":"1","id":"313474"},"customfield_312563":{"self":"https://tickets.reachlocal.com/rest/api/2/customFieldOption/313486","value":"12","id":"313486"},"customfield_312564":{"self":"https://tickets.reachlocal.com/rest/api/2/customFieldOption/313487","value":"Yes","id":"313487"},"customfield_312565":"CAD","customfield_312566":{"self":"https://tickets.reachlocal.com/rest/api/2/customFieldOption/313499","value":"11  Website","id":"313499"},"comment":{"startAt":0,"maxResults":3,"total":3,"comments":[{"self":"https://tickets.reachlocal.com/rest/api/2/issue/999196/comment/1227331","id":"1227331","author":{"self":"https://tickets.reachlocal.com/rest/api/2/user?username=stephen.caicedo","name":"stephen.caicedo","key":"stephen.caicedo","emailAddress":"stephen.caicedo@reachlocal.com","avatarUrls":{"48x48":"https://tickets.reachlocal.com/secure/useravatar?avatarId=10312","24x24":"https://tickets.reachlocal.com/secure/useravatar?size=small&avatarId=10312","16x16":"https://tickets.reachlocal.com/secure/useravatar?size=xsmall&avatarId=10312","32x32":"https://tickets.reachlocal.com/secure/useravatar?size=medium&avatarId=10312"},"displayName":"Stephen Caicedo","active":true,"timeZone":"US/Pacific"},"body":"What is the status of this ticket?","updateAuthor":{"self":"https://tickets.reachlocal.com/rest/api/2/user?username=stephen.caicedo","name":"stephen.caicedo","key":"stephen.caicedo","emailAddress":"stephen.caicedo@reachlocal.com","avatarUrls":{"48x48":"https://tickets.reachlocal.com/secure/useravatar?avatarId=10312","24x24":"https://tickets.reachlocal.com/secure/useravatar?size=small&avatarId=10312","16x16":"https://tickets.reachlocal.com/secure/useravatar?size=xsmall&avatarId=10312","32x32":"https://tickets.reachlocal.com/secure/useravatar?size=medium&avatarId=10312"},"displayName":"Stephen Caicedo","active":true,"timeZone":"US/Pacific"},"created":"2017-09-12T13:31:02.000-0700","updated":"2017-09-12T13:31:02.000-0700"},{"self":"https://tickets.reachlocal.com/rest/api/2/issue/999196/comment/1233400","id":"1233400","author":{"self":"https://tickets.reachlocal.com/rest/api/2/user?username=dan.gesshel","name":"dan.gesshel","key":"daniel.gesshel","emailAddress":"dan.gesshel@reachlocal.com","avatarUrls":{"48x48":"https://tickets.reachlocal.com/secure/useravatar?avatarId=10312","24x24":"https://tickets.reachlocal.com/secure/useravatar?size=small&avatarId=10312","16x16":"https://tickets.reachlocal.com/secure/useravatar?size=xsmall&avatarId=10312","32x32":"https://tickets.reachlocal.com/secure/useravatar?size=medium&avatarId=10312"},"displayName":"Dan Gesshel","active":true,"timeZone":"US/Pacific"},"body":"Corrected the margin to 31.70 due to mis-calculation on my part. Thanks. Dan","updateAuthor":{"self":"https://tickets.reachlocal.com/rest/api/2/user?username=dan.gesshel","name":"dan.gesshel","key":"daniel.gesshel","emailAddress":"dan.gesshel@reachlocal.com","avatarUrls":{"48x48":"https://tickets.reachlocal.com/secure/useravatar?avatarId=10312","24x24":"https://tickets.reachlocal.com/secure/useravatar?size=small&avatarId=10312","16x16":"https://tickets.reachlocal.com/secure/useravatar?size=xsmall&avatarId=10312","32x32":"https://tickets.reachlocal.com/secure/useravatar?size=medium&avatarId=10312"},"displayName":"Dan Gesshel","active":true,"timeZone":"US/Pacific"},"created":"2017-09-23T15:18:25.000-0700","updated":"2017-09-23T15:18:25.000-0700"},{"self":"https://tickets.reachlocal.com/rest/api/2/issue/999196/comment/1233467","id":"1233467","author":{"self":"https://tickets.reachlocal.com/rest/api/2/user?username=seema.johnson","name":"seema.johnson","key":"seema.johnson","emailAddress":"seema.johnson@reachlocal.com","avatarUrls":{"48x48":"https://tickets.reachlocal.com/secure/useravatar?avatarId=10312","24x24":"https://tickets.reachlocal.com/secure/useravatar?size=small&avatarId=10312","16x16":"https://tickets.reachlocal.com/secure/useravatar?size=xsmall&avatarId=10312","32x32":"https://tickets.reachlocal.com/secure/useravatar?size=medium&avatarId=10312"},"displayName":"Seema Johnson","active":true,"timeZone":"US/Pacific"},"body":"Offer ID - 1462 created in QA. Need to adjust the offer per the requirement in the ticket. Test the Offer by creating Order and campaign in QA.","updateAuthor":{"self":"https://tickets.reachlocal.com/rest/api/2/user?username=seema.johnson","name":"seema.johnson","key":"seema.johnson","emailAddress":"seema.johnson@reachlocal.com","avatarUrls":{"48x48":"https://tickets.reachlocal.com/secure/useravatar?avatarId=10312","24x24":"https://tickets.reachlocal.com/secure/useravatar?size=small&avatarId=10312","16x16":"https://tickets.reachlocal.com/secure/useravatar?size=xsmall&avatarId=10312","32x32":"https://tickets.reachlocal.com/secure/useravatar?size=medium&avatarId=10312"},"displayName":"Seema Johnson","active":true,"timeZone":"US/Pacific"},"created":"2017-09-24T17:37:18.000-0700","updated":"2017-09-24T17:37:18.000-0700"}]},"customfield_312053":null,"customfield_312174":null,"customfield_312175":null,"customfield_312176":null,"customfield_312055":{"errorMessage":"The Service Desk you are trying to view does not exist.","i18nErrorMessage":{"i18nKey":"sd.agent.servicedesk.error.servicedesk.missing","parameters":[]}},"fixVersions":[{"self":"https://tickets.reachlocal.com/rest/api/2/version/310755","id":"310755","description":"","name":"Backlog","archived":false,"released":false,"releaseDate":"2017-07-28"}],"customfield_312177":null,"customfield_312056":{"errorMessage":"The Service Desk you are trying to view does not exist.","i18nErrorMessage":{"i18nKey":"sd.agent.servicedesk.error.servicedesk.missing","parameters":[]}},"customfield_312178":null,"customfield_312057":null,"customfield_312179":null,"customfield_312058":null,"customfield_312059":null,"customfield_312170":null,"customfield_312050":null,"customfield_312171":null,"customfield_312172":null,"customfield_312051":null,"customfield_312173":null,"customfield_312052":null,"customfield_312185":null,"customfield_312064":null,"customfield_312186":null,"customfield_312065":{"errorMessage":"The Service Desk you are trying to view does not exist.","i18nErrorMessage":{"i18nKey":"sd.agent.servicedesk.error.servicedesk.missing","parameters":[]}},"customfield_312066":null,"customfield_312187":null,"customfield_312188":null,"customfield_312067":null,"priority":{"self":"https://tickets.reachlocal.com/rest/api/2/priority/4","iconUrl":"https://tickets.reachlocal.com/images/icons/priorities/minor.svg","name":"Medium","id":"4"},"customfield_312189":null,"customfield_312069":null,"customfield_312180":null,"customfield_312060":null,"customfield_312181":null,"versions":[],"customfield_312061":null,"customfield_312182":null,"customfield_312062":null,"customfield_312183":null,"customfield_312184":null,"customfield_312063":null,"customfield_312075":null,"customfield_312077":{"self":"https://tickets.reachlocal.com/rest/api/2/customFieldOption/312918","value":"No","id":"312918"},"customfield_312078":null,"customfield_312079":null,"customfield_312190":null,"customfield_312070":null,"customfield_312071":null,"customfield_312072":null,"customfield_312073":null,"customfield_312074":null,"customfield_312086":null,"customfield_312087":null,"customfield_312088":null,"customfield_312089":null,"aggregateprogress":{"progress":0,"total":0},"customfield_312080":null,"customfield_312081":null,"customfield_312082":null,"customfield_312083":null,"customfield_312084":null,"customfield_312085":null,"customfield_312017":null,"customfield_312018":null,"customfield_312019":null,"customfield_312251":null,"customfield_312130":null,"customfield_312131":null,"customfield_312252":null,"customfield_312010":null,"customfield_312132":null,"customfield_312011":null,"customfield_312254":null,"customfield_312012":null,"customfield_312133":null,"customfield_312134":null,"customfield_312013":null,"customfield_312255":null,"customfield_312014":null,"customfield_312135":null,"customfield_312015":null,"customfield_312016":null,"customfield_312250":null,"customfield_312028":null,"customfield_312029":null,"created":"2017-08-24T10:29:14.000-0700","customfield_312020":null,"customfield_312021":null,"customfield_312022":null,"customfield_312023":null,"customfield_312024":null,"customfield_312025":null,"customfield_312026":null,"customfield_312027":null,"customfield_311050":null,"customfield_312039":null,"customfield_10090":null,"customfield_312152":null,"customfield_312031":null,"customfield_312032":null,"customfield_312153":null,"customfield_312154":null,"customfield_312033":null,"customfield_312155":null,"customfield_312034":null,"customfield_312156":null,"customfield_312035":null,"customfield_312157":null,"customfield_312036":null,"customfield_312158":null,"customfield_312037":null,"customfield_312159":null,"customfield_312038":null,"customfield_312150":null,"customfield_312151":null,"customfield_312030":null,"customfield_10083":null,"customfield_312042":null,"customfield_312163":null,"customfield_312043":null,"customfield_312164":null,"customfield_312044":null,"customfield_312165":null,"customfield_312166":null,"customfield_312045":null,"customfield_312046":null,"customfield_312167":null,"customfield_312047":null,"customfield_312168":null,"customfield_312048":null,"customfield_312169":null,"customfield_312049":null,"customfield_312160":null,"customfield_312161":null,"customfield_312040":null,"customfield_312041":null,"customfield_312162":null}}
    $scope.jiraFieldMapping={
    		"offerName":"customfield_312555",
    		"retailPrice":"customfield_312559",
    		"vendorMinBudget":"customfield_312560",
    		"vendorMaxBudget":"customfield_312560",
    		"isLumpSum":"customfield_312562",
    		"maxRenewalCycles":"customfield_312563",
    		"currency":"customfield_312567",
    		"productFamilyId":"customfield_312566",
    		"idWebPublisher":"customfield_312655",
    		"idCampaignType":"customfield_312656",
    		"idCampaignSubType":"customfield_312657",
    		"markUpPercent":"customfield_312750"
    		
    }

    $scope.templateFields=[{
    	"name":"Offer NameÂ®:",
    	"type":"offer",
    	"model":"offerName"
    },{
    	"name":"Retail Price",
    	"type":"offer",
    	"model":""
    },{
    	"name":"Offer Minimum Price (Vendor Minimum Price)(R):",
    	"type":"offer",
    	"model":"vendorMinBudget"
    },
    {
    	"name":"Offer Max Price(R):",
    	"type":"offer",
    	"model":"vendorMaxBudget"
    },
    {
    	"name":"Lumpsum Flag(R):",
    	"type":"offer",
    	"model":"isLumpSum"
    },
    {
    	"name":"No. of Cycles (R):",
    	"type":"offer",
    	"model":"maxRenewalCycles"
    },
    {
    	"name":"Evergreen Eligible (yes/No)(R):",
    	"type":"offer",
    	"model":""
    },
    {
    	"name":"Currency to be used(R):",
    	"type":"offer",
    	"model":"currency"
    },{
    	"name":"Product Family (R):",
    	"type":"productFamily",
    	"model":"productFamilyId"
    },{
    	"name":"Platform/Country on which this offer should be created.(R):",
    	"type":"productFamily",
    	"model":""
    },{
    	"name":"Margin Rate:",
    	"type":"hasMarginPercents",
    	"model":""
    },{
    	"name":"Product URI:",
    	"type":"productFamily",
    	"model":""
    },{
    	"name":"What BID's should these new offers be enabled:",
    	"type":"hasMarginPercents",
    	"model":""
    },{
    	"name":"Business Justification:",
    	"type":"productFamily",
    	"model":""
    },{
    	"name":"Priority Flag:",
    	"type":"productFamily",
    	"model":""
    },{
    	"name":"Priority Justification:",
    	"type":"productFamily",
    	"model":""
    },{
    	"name":"Product owner:",
    	"type":"productFamily",
    	"model":"productFamilyId"
    },{
    	"name":"Web Publisher ID to be used for the new offer:",
    	"type":"offer",
    	"model":"idWebPublisher"
    },{
    	"name":"Campaign Type to be used(R):",
    	"type":"offer",
    	"model":"idCampaignType"
    },{
    	"name":"CampaignSubType to be used(R):",
    	"type":"offer",
    	"model":"idCampaignSubType"
    },{
    	"name":"Margin Percentage(yes/no)(R):",
    	"type":"hasMarginPercents",
    	"model":""
    },{
    	"name":"Margin Percentage:",
    	"type":"hasMarginPercents",
    	"model":"markUpPercent"
    }
    ]

    $scope.fetchDetails = function(){
    	$scope.error = "";
    	$scope.showValue = false;
    	$scope.submitted = true;

    	if($scope.id) {
            $scope.showLoading = true;
            offerService.fetchOffer($scope.id).then(function (response) {
            	if(response.offer){
            	$scope.offerDetails = response;
            	if($scope.ticketNo){
            		offerService.fetchJiraDetails($scope.ticketNo).then(function(response){
            			$scope.jira=response.data;
            			setTimeout(function(){
            			$scope.mapJiraFields();
            			$scope.$apply();
            			},0);
            			$scope.showLoading = false;
            			$scope.showValue = true;
            		});

            	} else {
            		$scope.showLoading = false;
        			$scope.showValue = true;
            	}
            	} else {
            		$scope.error="Offer Id not present or Invalid input"
            		$scope.showLoading = false;
            	}
            });


    	} 


    }

    $scope.blocked = ["id","idOffer","offerId"];

    $scope.isArray = angular.isArray;
    $scope.isBlocked = function(val){
    	console.log(val)
    	return $scope.blocked.indexOf(val)==-1
    }
    $scope.cloneOffer = function(){
    	 offerService.cloneOffer($scope.offerDetails).then(function(response){
    		});
    }
    $scope.removeRow = function(row,index){
    	row.splice(index, 1);
    	console.log(row,index);
    	
    }
    $scope.addRow = function (tableName,rows) {
        rows.push(models[tableName]);
        
        setTimeout(function(){$scope.showFields = true;},0);
    }
    $scope.mapJiraFields = function(){
    	$scope.offerDetails.offer.offerName=$scope.jira.fields[$scope.jiraFieldMapping["offerName"]];
    	$scope.offerDetails.offer.vendorMinBudget=$scope.jira.fields[$scope.jiraFieldMapping["vendorMinBudget"]];
    	$scope.offerDetails.offer.vendorMaxBudget=$scope.jira.fields[$scope.jiraFieldMapping["vendorMaxBudget"]];
    	$scope.offerDetails.offer.isLumpSum=$scope.jira.fields[$scope.jiraFieldMapping["isLumpSum"]].value;
    	$scope.offerDetails.offer.maxRenewalCycles=$scope.jira.fields[$scope.jiraFieldMapping["maxRenewalCycles"]].value;
    	$scope.offerDetails.offer.currency=$scope.jira.fields[$scope.jiraFieldMapping["currency"]];
    	//$scope.offerDetails.productFamilyOffer[0].productFamilyId=$scope.jira.fields[$scope.jiraFieldMapping["productFamilyId"]].value;
    	$scope.offerDetails.offer.idWebPublisher=$scope.jira.fields[$scope.jiraFieldMapping["idWebPublisher"]];
    	$scope.offerDetails.offer.idCampaignType=$scope.jira.fields[$scope.jiraFieldMapping["idCampaignType"]];
    	$scope.offerDetails.offer.idCampaignSubType=$scope.jira.fields[$scope.jiraFieldMapping["idCampaignSubType"]];
    	$scope.offerDetails.offer.markUpPercent=$scope.jira.fields[$scope.jiraFieldMapping["markUpPercent"]][0].value;
    	
    	
    }
    
});